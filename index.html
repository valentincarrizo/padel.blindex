<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Padel Blindex - Tres Algarrobos</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f2f2f2;
      text-align: center;
    }
    h1 {
      color: #00796B;
      margin-top: 20px;
    }
    .turno {
      margin: 10px;
      padding: 10px;
      border-radius: 8px;
      display: inline-block;
      width: 200px;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .libre {
      border: 2px solid green;
    }
    .ocupado {
      border: 2px solid red;
      opacity: 0.5;
    }
    button {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Padel Blindex - Tres Algarrobos</h1>
  <div id="agenda"></div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCbF1MRSNxEShlOZ2PIPH1op91CvIiUexI",
  authDomain: "padel-blindex.firebaseapp.com",
  projectId: "padel-blindex",
  storageBucket: "padel-blindex.firebasestorage.app",
  messagingSenderId: "584258566195",
  appId: "1:584258566195:web:0be432309ca1006c488b46",
  measurementId: "G-SMPLB9YYMR"
};

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const agendaDiv = document.getElementById("agenda");

    const horas = generarTurnos("08:00", "22:00");

    function generarTurnos(inicio, fin) {
      const turnos = [];
      let [h, m] = inicio.split(":").map(Number);
      const [hFin, mFin] = fin.split(":").map(Number);

      while (h < hFin || (h === hFin && m < mFin)) {
        const hora = `${h.toString().padStart(2, "0")}:${m.toString().padStart(2, "0")}`;
        turnos.push(hora);
        m += 30;
        if (m === 60) {
          h++;
          m = 0;
        }
      }
      return turnos;
    }

    function mostrarAgenda(data = {}) {
      agendaDiv.innerHTML = "";
      horas.forEach(hora => {
        const ocupado = data[hora];
        const div = document.createElement("div");
        div.className = `turno ${ocupado ? "ocupado" : "libre"}`;
        div.innerHTML = `<strong>${hora}</strong><br>`;
        if (!ocupado) {
          const boton = document.createElement("button");
          boton.textContent = "Reservar";
          boton.onclick = () => reservarTurno(hora);
          div.appendChild(boton);
        } else {
          div.innerHTML += "<small>Ocupado</small>";
        }
        agendaDiv.appendChild(div);
      });
    }

    function reservarTurno(hora) {
      set(ref(db, "turnos/" + hora), true);
    }

    // Escuchar cambios en la base de datos
    const turnosRef = ref(db, "turnos");
    onValue(turnosRef, snapshot => {
      const data = snapshot.val() || {};
      mostrarAgenda(data);
    });
  </script>
</body>
</html>

